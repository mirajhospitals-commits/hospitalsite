<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Medical Connect - Complete Hospital Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè•</text></svg>">
    <style>
        :root {
            --primary: #0066cc;
            --primary-dark: #004d99;
            --primary-light: #e6f2ff;
            --secondary: #2e7d32;
            --secondary-light: #e8f5e9;
            --accent: #ff6b35;
            --text: #333;
            --text-light: #666;
            --border: #e0e0e0;
            --bg: #f8fafc;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --shadow: 0 5px 15px rgba(0,0,0,0.08);
            --radius: 10px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .logo i {
            font-size: 2rem;
            color: var(--primary);
        }
        
        .logo h1 {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .logo span {
            color: var(--accent);
        }
        
        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .search-box {
            display: flex;
            background: white;
            border: 1px solid var(--border);
            border-radius: 25px;
            overflow: hidden;
            padding: 8px 15px;
            width: 300px;
            transition: all 0.3s;
        }
        
        .search-box:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary-light);
        }
        
        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            padding: 0 10px;
            font-size: 0.95rem;
        }
        
        .search-box button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            padding: 0 5px;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Main Navigation */
        .main-nav {
            background: var(--primary);
            color: white;
            position: sticky;
            top: 72px;
            z-index: 999;
        }
        
        .nav-tabs {
            display: flex;
            list-style: none;
            padding: 0;
        }
        
        .nav-tabs li {
            flex: 1;
        }
        
        .nav-tabs a {
            display: block;
            padding: 15px 20px;
            text-align: center;
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tabs a:hover, .nav-tabs a.active {
            background: rgba(255,255,255,0.1);
            border-bottom: 3px solid var(--accent);
        }
        
        .nav-tabs i {
            margin-right: 8px;
        }
        
        /* Main Content */
        .main-content {
            padding: 30px 0;
            min-height: calc(100vh - 280px);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-header h2 {
            color: var(--primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .view-all {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .view-all:hover {
            gap: 10px;
            color: var(--primary-dark);
        }
        
        /* Hospital Grid */
        .hospital-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .hospital-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .hospital-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .hospital-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            position: relative;
        }
        
        .hospital-type {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            backdrop-filter: blur(5px);
        }
        
        .hospital-header h3 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .hospital-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .hospital-rating i {
            color: #ffc107;
        }
        
        .hospital-body {
            padding: 20px;
        }
        
        .hospital-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .detail-item i {
            color: var(--primary);
            width: 20px;
            text-align: center;
        }
        
        .specialties {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .specialty-tag {
            background: var(--primary-light);
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .specialty-tag:hover {
            background: var(--primary);
            color: white;
        }
        
        .hospital-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
            flex: 2;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: var(--primary-light);
            color: var(--primary);
            flex: 1;
        }
        
        .btn-secondary:hover {
            background: #d1e7ff;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--secondary);
            color: white;
        }
        
        .btn-success:hover {
            background: #1b5e20;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: var(--warning);
            color: #333;
        }
        
        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        /* Services Grid */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .service-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .service-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-light) 0%, #d1e7ff 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        .service-card h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .service-card p {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .service-features {
            list-style: none;
            text-align: left;
            margin-top: 15px;
        }
        
        .service-features li {
            padding: 5px 0;
            color: var(--text-light);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .service-features i {
            color: var(--secondary);
        }
        
        /* Appointment Section */
        .appointment-section {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }
        
        .appointment-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .form-group label:after {
            content: "*";
            color: var(--danger);
            margin-left: 2px;
        }
        
        .form-group label.optional:after {
            content: "";
        }
        
        .form-group select, .form-group input, .form-group textarea {
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-group select:focus, .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary-light);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }
        
        .appointment-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn-large {
            padding: 15px 30px;
            font-size: 1.1rem;
            min-width: 200px;
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        .btn-accent:hover {
            background: #e55a2b;
            transform: translateY(-2px);
        }
        
        /* Recent Appointments */
        .appointments-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .appointments-table th {
            background: var(--primary-light);
            padding: 15px;
            text-align: left;
            color: var(--primary);
            font-weight: 600;
        }
        
        .appointments-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .appointments-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-confirmed {
            background: var(--secondary-light);
            color: var(--secondary);
        }
        
        .status-pending {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .status-cancelled {
            background: #f8d7da;
            color: var(--danger);
        }
        
        .status-completed {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        /* Filters */
        .filters {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-end;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 150px;
        }
        
        .filter-group label {
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            font-size: 0.9rem;
        }
        
        .filter-group select {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 0.95rem;
        }
        
        /* Footer */
        footer {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #003366 100%);
            color: white;
            padding: 40px 0 20px;
            margin-top: 40px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-section h3 {
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: white;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #cce0ff;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #cce0ff;
            font-size: 0.9rem;
        }
        
        /* Digital Health Card Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(3px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            z-index: 10;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: var(--primary-light);
            color: var(--primary);
        }
        
        /* Digital Health Card Styling */
        .health-card {
            background: linear-gradient(135deg, #0066cc 0%, #004d99 100%);
            color: white;
            padding: 30px;
            border-radius: 15px 15px 0 0;
            position: relative;
            overflow: hidden;
        }
        
        .card-watermark {
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 120px;
            opacity: 0.1;
            color: white;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .card-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-logo i {
            font-size: 2rem;
        }
        
        .card-logo h2 {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .card-type {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
        }
        
        .qr-code-placeholder {
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            margin: 20px auto;
            padding: 10px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .qr-code-placeholder i {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .qr-code-placeholder span {
            font-size: 0.8rem;
            text-align: center;
            font-weight: 600;
        }
        
        .card-details {
            background: white;
            padding: 30px;
            color: var(--text);
        }
        
        .appointment-id {
            text-align: center;
            background: var(--bg);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            letter-spacing: 1px;
            color: var(--primary);
            font-weight: bold;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
            align-items: flex-start;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            color: var(--text-light);
            font-weight: 500;
            flex: 1;
        }
        
        .detail-value {
            font-weight: 600;
            text-align: right;
            flex: 2;
            word-break: break-word;
        }
        
        .card-footer {
            background: #f8fafc;
            padding: 20px 30px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn-outline {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }
        
        /* Saved Cards Section */
        .saved-cards-section {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-top: 30px;
            display: none;
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .mini-health-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            border-radius: var(--radius);
            position: relative;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }
        
        .mini-health-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .mini-health-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent);
        }
        
        .mini-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .mini-appointment-id {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            background: rgba(255,255,255,0.2);
            padding: 3px 10px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }
        
        .mini-card-details p {
            margin: 5px 0;
            font-size: 0.9rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Data Management */
        .data-management {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .data-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        /* Storage Status */
        .storage-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--primary);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 100;
            animation: slideInLeft 0.3s ease;
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .storage-status i {
            animation: spin 4s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: var(--radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 2001;
            animation: slideInRight 0.3s ease;
            max-width: 350px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast-success {
            border-left: 4px solid var(--secondary);
        }
        
        .toast-error {
            border-left: 4px solid var(--danger);
        }
        
        .toast-info {
            border-left: 4px solid var(--primary);
        }
        
        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--primary-light);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        /* Emergency Banner */
        .emergency-banner {
            background: linear-gradient(135deg, var(--accent) 0%, #e55a2b 100%);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: var(--radius);
            animation: pulse 2s infinite;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }
        
        .empty-state i {
            font-size: 3rem;
            color: var(--border);
            margin-bottom: 15px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-box {
                width: 100%;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tabs li {
                width: 100%;
            }
            
            .hospital-grid {
                grid-template-columns: 1fr;
            }
            
            .hospital-details {
                grid-template-columns: 1fr;
            }
            
            .appointment-form {
                grid-template-columns: 1fr;
            }
            
            .filter-options {
                flex-direction: column;
                align-items: stretch;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .card-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .card-actions button {
                width: 100%;
            }
            
            .card-footer {
                flex-direction: column;
                gap: 15px;
            }
            
            .appointment-actions {
                flex-direction: column;
            }
            
            .btn-large {
                width: 100%;
            }
            
            .data-actions {
                flex-direction: column;
            }
            
            .data-actions button {
                width: 100%;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .social-links {
                justify-content: center;
            }
            
            .storage-status {
                left: 10px;
                right: 10px;
                bottom: 10px;
                font-size: 0.8rem;
            }
            
            .modal-content {
                width: 95%;
                max-width: 95%;
            }
            
            .detail-row {
                flex-direction: column;
                gap: 5px;
            }
            
            .detail-label, .detail-value {
                text-align: left;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .logo h1 {
                font-size: 1.2rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .hospital-actions {
                flex-direction: column;
            }
            
            .appointments-table {
                display: block;
                overflow-x: auto;
            }
        }
        
        @media print {
            .modal {
                background: white;
            }
            
            .modal-close,
            .card-actions,
            .storage-status,
            header,
            .main-nav,
            footer,
            .data-management {
                display: none !important;
            }
            
            .modal-content {
                box-shadow: none;
                max-width: 100%;
                margin: 0;
                padding: 0;
            }
            
            .health-card, .card-details, .card-footer {
                padding: 15px;
            }
            
            .qr-code-placeholder {
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="scrollToTop(event)">
                    <i class="fas fa-hospital-alt"></i>
                    <h1>City<span>Medical</span> Connect</h1>
                </a>
                
                <div class="header-controls">
                    <div class="search-box">
                        <input type="text" placeholder="Search hospitals, doctors, services..." id="search-input">
                        <button id="search-button"><i class="fas fa-search"></i></button>
                    </div>
                    
                    <div class="user-menu">
                        <div class="avatar" title="Click to view profile" onclick="showUserProfile()">JD</div>
                        <div>
                            <p style="font-weight: 500;">John Doe</p>
                            <small style="color: var(--text-light);">Patient</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="container">
            <ul class="nav-tabs">
                <li><a href="#hospitals" class="active" onclick="switchTab('hospitals')"><i class="fas fa-hospital"></i> Hospitals</a></li>
                <li><a href="#appointments" onclick="switchTab('appointments')"><i class="fas fa-calendar-check"></i> Appointments</a></li>
                <li><a href="#services" onclick="switchTab('services')"><i class="fas fa-stethoscope"></i> Services</a></li>
                <li><a href="#health-cards" onclick="switchTab('health-cards')"><i class="fas fa-id-card"></i> Health Cards</a></li>
                <li><a href="#data" onclick="switchTab('data')"><i class="fas fa-database"></i> Data</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Emergency Banner -->
    <div class="container">
        <div class="emergency-banner" id="emergency-banner">
            <i class="fas fa-ambulance"></i> 
            <strong>EMERGENCY:</strong> Call 911 or visit nearest emergency room for immediate assistance
        </div>
    </div>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Hospitals Section (Default) -->
            <section id="hospitals-section" class="tab-content active">
                <div class="section-header">
                    <h2><i class="fas fa-hospital"></i> Hospitals in Our City</h2>
                    <div class="filter-options">
                        <div class="filter-group">
                            <label>Hospital Type</label>
                            <select id="filter-type">
                                <option value="">All Types</option>
                                <option value="general">General Hospital</option>
                                <option value="specialty">Specialty Hospital</option>
                                <option value="clinic">Clinic</option>
                                <option value="multispecialty">Multispecialty</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Area/Location</label>
                            <select id="filter-area">
                                <option value="">All Areas</option>
                                <option value="north">North City</option>
                                <option value="south">South City</option>
                                <option value="east">East City</option>
                                <option value="west">West City</option>
                                <option value="central">Central</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="apply-filters">
                            <i class="fas fa-filter"></i> Apply Filters
                        </button>
                        <button class="btn btn-secondary" id="clear-filters">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                </div>
                
                <div class="hospital-grid" id="hospital-list">
                    <!-- Hospitals will be loaded here -->
                </div>
            </section>
            
            <!-- Appointments Section -->
            <section id="appointments-section" class="tab-content">
                <div class="section-header">
                    <h2><i class="fas fa-calendar-check"></i> Book Appointment</h2>
                    <a href="#appointment-list" class="view-all" onclick="switchTab('health-cards')">
                        View Health Cards <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <div class="appointment-section">
                    <p>Schedule your visit to any hospital in the city. All fields marked with * are required.</p>
                    
                    <form id="appointment-form" class="appointment-form">
                        <div class="form-group">
                            <label for="hospital-select"><i class="fas fa-hospital"></i> Select Hospital</label>
                            <select id="hospital-select" required>
                                <option value="">Choose a hospital...</option>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="department-select"><i class="fas fa-stethoscope"></i> Department/Specialty</label>
                            <select id="department-select" required>
                                <option value="">Select department...</option>
                                <option value="cardiology">Cardiology</option>
                                <option value="orthopedics">Orthopedics</option>
                                <option value="neurology">Neurology</option>
                                <option value="pediatrics">Pediatrics</option>
                                <option value="dermatology">Dermatology</option>
                                <option value="general">General Medicine</option>
                                <option value="emergency">Emergency</option>
                                <option value="surgery">Surgery</option>
                                <option value="radiology">Radiology</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment-date"><i class="fas fa-calendar-alt"></i> Preferred Date</label>
                            <input type="date" id="appointment-date" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="time-slot"><i class="fas fa-clock"></i> Preferred Time</label>
                            <select id="time-slot" required>
                                <option value="">Select time slot...</option>
                                <option value="9-10">9:00 AM - 10:00 AM</option>
                                <option value="10-11">10:00 AM - 11:00 AM</option>
                                <option value="11-12">11:00 AM - 12:00 PM</option>
                                <option value="1-2">1:00 PM - 2:00 PM</option>
                                <option value="2-3">2:00 PM - 3:00 PM</option>
                                <option value="3-4">3:00 PM - 4:00 PM</option>
                                <option value="4-5">4:00 PM - 5:00 PM</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="patient-name"><i class="fas fa-user"></i> Patient Name</label>
                            <input type="text" id="patient-name" value="John Doe" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="patient-contact"><i class="fas fa-phone"></i> Contact Number</label>
                            <input type="tel" id="patient-contact" value="+1 (555) 123-4567" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="patient-notes" class="optional"><i class="fas fa-file-medical-alt"></i> Symptoms/Notes</label>
                            <textarea id="patient-notes" placeholder="Describe your symptoms or any special requirements..."></textarea>
                        </div>
                    </form>
                    
                    <div class="appointment-actions">
                        <button class="btn btn-primary btn-large" id="book-appointment">
                            <i class="fas fa-calendar-check"></i> Book Appointment
                        </button>
                        <button class="btn btn-accent btn-large" id="emergency-appointment">
                            <i class="fas fa-ambulance"></i> Emergency Assistance
                        </button>
                    </div>
                </div>
                
                <!-- Recent Appointments Table -->
                <div style="margin-top: 40px;">
                    <div class="section-header">
                        <h2><i class="fas fa-history"></i> Recent Appointments</h2>
                    </div>
                    
                    <div class="appointments-table-container">
                        <table class="appointments-table">
                            <thead>
                                <tr>
                                    <th>Hospital</th>
                                    <th>Department</th>
                                    <th>Date & Time</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="appointments-table-body">
                                <!-- Appointments loaded here -->
                            </tbody>
                        </table>
                        <div id="no-appointments" class="empty-state" style="display: none;">
                            <i class="fas fa-calendar-times"></i>
                            <h3>No Appointments Yet</h3>
                            <p>Book your first appointment above to get started!</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Services Section -->
            <section id="services-section" class="tab-content">
                <div class="section-header">
                    <h2><i class="fas fa-stethoscope"></i> Medical Services</h2>
                    <a href="#hospitals" class="view-all" onclick="switchTab('hospitals')">
                        Find Hospitals <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <div class="services-grid" id="services-list">
                    <!-- Services loaded here -->
                </div>
            </section>
            
            <!-- Health Cards Section -->
            <section id="health-cards-section" class="tab-content">
                <div class="saved-cards-section">
                    <div class="section-header">
                        <h2><i class="fas fa-id-card"></i> My Health Cards</h2>
                        <span class="status-badge status-confirmed" id="card-count">0 cards</span>
                    </div>
                    
                    <p>Your digital health cards. Present at hospital reception for quick check-in. Click any card to view details.</p>
                    
                    <div class="card-grid" id="health-cards-list">
                        <!-- Health cards loaded here -->
                    </div>
                    <div id="no-cards" class="empty-state">
                        <i class="fas fa-id-card"></i>
                        <h3>No Health Cards Yet</h3>
                        <p>Book an appointment to get your first digital health card!</p>
                        <button class="btn btn-primary" onclick="switchTab('appointments')" style="margin-top: 15px;">
                            <i class="fas fa-calendar-plus"></i> Book Appointment
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Data Management Section -->
            <section id="data-section" class="tab-content">
                <div class="data-management">
                    <div class="section-header">
                        <h2><i class="fas fa-database"></i> Data Management</h2>
                    </div>
                    <p>All your data is stored within this single HTML file. No external database required!</p>
                    
                    <div class="data-actions">
                        <button class="btn btn-success" onclick="exportHTMLWithData()">
                            <i class="fas fa-download"></i> Save Complete HTML
                        </button>
                        <button class="btn btn-primary" onclick="backupData()">
                            <i class="fas fa-save"></i> Backup Data Now
                        </button>
                        <button class="btn btn-secondary" onclick="loadDataFromFile()">
                            <i class="fas fa-upload"></i> Import Data
                        </button>
                        <button class="btn btn-warning" onclick="showDataInEditor()">
                            <i class="fas fa-code"></i> View Raw Data
                        </button>
                        <button class="btn btn-danger" onclick="resetAllData()">
                            <i class="fas fa-trash"></i> Reset All Data
                        </button>
                    </div>
                    
                    <div style="margin-top: 25px; background: var(--bg); padding: 15px; border-radius: var(--radius);">
                        <h4 style="margin-bottom: 10px;"><i class="fas fa-info-circle"></i> How It Works:</h4>
                        <ul style="color: var(--text-light); padding-left: 20px;">
                            <li>All data is stored within this HTML file</li>
                            <li>Click "Save Complete HTML" to download with all data</li>
                            <li>Share the downloaded file with anyone - they see all your data</li>
                            <li>Works completely offline, no internet required</li>
                            <li>Auto-saves every time you make changes</li>
                        </ul>
                    </div>
                    
                    <input type="file" id="dataFileInput" accept=".html,.json" style="display: none;">
                </div>
                
                <!-- Statistics -->
                <div class="data-management" style="margin-top: 20px;">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-bar"></i> Statistics</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: var(--primary-light); padding: 15px; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--primary);" id="stats-hospitals">5</div>
                            <div style="color: var(--text-light);">Hospitals</div>
                        </div>
                        <div style="background: var(--secondary-light); padding: 15px; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--secondary);" id="stats-appointments">0</div>
                            <div style="color: var(--text-light);">Appointments</div>
                        </div>
                        <div style="background: var(--primary-light); padding: 15px; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--primary);" id="stats-services">4</div>
                            <div style="color: var(--text-light);">Services</div>
                        </div>
                        <div style="background: var(--secondary-light); padding: 15px; border-radius: var(--radius);">
                            <div style="font-size: 2rem; font-weight: bold; color: var(--secondary);" id="stats-healthcards">0</div>
                            <div style="color: var(--text-light);">Health Cards</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>City Medical Connect</h3>
                    <p>Your trusted partner in healthcare. Connecting patients with hospitals and medical services across the city.</p>
                    <div class="social-links">
                        <a href="#" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#hospitals" onclick="switchTab('hospitals')"><i class="fas fa-chevron-right"></i> Find Hospitals</a></li>
                        <li><a href="#services" onclick="switchTab('services')"><i class="fas fa-chevron-right"></i> Medical Services</a></li>
                        <li><a href="#appointments" onclick="switchTab('appointments')"><i class="fas fa-chevron-right"></i> Book Appointment</a></li>
                        <li><a href="#health-cards" onclick="switchTab('health-cards')"><i class="fas fa-chevron-right"></i> My Health Cards</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Emergency Contacts</h3>
                    <ul class="footer-links">
                        <li><a href="tel:911"><i class="fas fa-phone"></i> Emergency: 911</a></li>
                        <li><a href="tel:5551234567"><i class="fas fa-phone-alt"></i> Support: (555) 123-4567</a></li>
                        <li><a href="mailto:help@citymedicalconnect.org"><i class="fas fa-envelope"></i> help@citymedicalconnect.org</a></li>
                        <li><i class="fas fa-map-marker-alt"></i> 123 Medical Center, City</li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 City Medical Connect. All rights reserved. | A platform connecting healthcare across the city</p>
                <p style="margin-top: 5px; font-size: 0.8rem;">Data stored in HTML | Version 2.0</p>
            </div>
        </div>
    </footer>
    
    <!-- Digital Health Card Modal -->
    <div id="health-card-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            
            <!-- Digital Health Card Content -->
            <div class="health-card">
                <div class="card-watermark">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <div class="card-header">
                    <div class="card-logo">
                        <i class="fas fa-hospital-alt"></i>
                        <h2>City<span>Medical</span> Connect</h2>
                    </div>
                    <div class="card-type">DIGITAL HEALTH CARD</div>
                </div>
                
                <div class="qr-code-placeholder">
                    <i class="fas fa-qrcode"></i>
                    <span>Scan at Hospital Reception</span>
                </div>
            </div>
            
            <div class="card-details">
                <div class="appointment-id" id="modal-appointment-id">APPT-000000</div>
                
                <div class="detail-row">
                    <div class="detail-label">Patient Name</div>
                    <div class="detail-value" id="modal-patient-name">John Doe</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Hospital</div>
                    <div class="detail-value" id="modal-hospital">City General Hospital</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Department</div>
                    <div class="detail-value" id="modal-department">Cardiology</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Date & Time</div>
                    <div class="detail-value" id="modal-datetime">Oct 15, 2023 at 10:00 AM</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Contact</div>
                    <div class="detail-value" id="modal-contact">+1 (555) 123-4567</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Status</div>
                    <div class="detail-value">
                        <span class="status-badge status-confirmed" id="modal-status">Confirmed</span>
                    </div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Issued On</div>
                    <div class="detail-value" id="modal-issued-date">Oct 10, 2023</div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label">Symptoms/Notes</div>
                    <div class="detail-value" id="modal-notes">No additional notes</div>
                </div>
            </div>
            
            <div class="card-footer">
                <div class="card-actions">
                    <button class="btn btn-outline" onclick="printHealthCard()">
                        <i class="fas fa-print"></i> Print Card
                    </button>
                    <button class="btn btn-outline" onclick="downloadHealthCard()">
                        <i class="fas fa-download"></i> Save as PDF
                    </button>
                </div>
                <button class="btn btn-success" onclick="addToWallet()">
                    <i class="fas fa-plus-circle"></i> Add to My Wallet
                </button>
            </div>
        </div>
    </div>
    
    <!-- Storage Status -->
    <div class="storage-status" id="storage-status">
        <i class="fas fa-database"></i>
        <span id="storage-info">All data stored in this HTML file</span>
    </div>

    <!-- ============================================
    DATA STORAGE - EMBEDDED IN HTML
    ============================================ -->
    
    <!-- Initial data embedded directly in HTML -->
    <script id="medical-data" type="application/json">
    {
        "hospitals": [
            {
                "id": "HOS_001",
                "name": "City General Hospital",
                "type": "general",
                "area": "central",
                "address": "123 Medical Center Blvd, Central City",
                "phone": "(555) 123-4567",
                "emergency": true,
                "rating": 4.5,
                "specialties": ["Cardiology", "Neurology", "General Surgery", "Emergency Care", "Pediatrics", "Radiology"],
                "description": "Full-service hospital with 24/7 emergency services and state-of-the-art facilities",
                "distance": "2.5 miles",
                "email": "info@citygeneralhospital.org",
                "website": "www.citygeneralhospital.org",
                "beds": 450,
                "doctors": 120
            },
            {
                "id": "HOS_002",
                "name": "Northside Medical Center",
                "type": "multispecialty",
                "area": "north",
                "address": "456 Health Park Dr, North City",
                "phone": "(555) 234-5678",
                "emergency": true,
                "rating": 4.7,
                "specialties": ["Orthopedics", "Pediatrics", "Oncology", "Maternity", "Cardiac Care", "Neurology"],
                "description": "Modern multispecialty hospital with advanced facilities and expert medical staff",
                "distance": "5.2 miles",
                "email": "contact@northsidemedical.org",
                "website": "www.northsidemedical.org",
                "beds": 320,
                "doctors": 95
            },
            {
                "id": "HOS_003",
                "name": "Children's Health Institute",
                "type": "specialty",
                "area": "west",
                "address": "789 Pediatric Way, West City",
                "phone": "(555) 345-6789",
                "emergency": true,
                "rating": 4.8,
                "specialties": ["Pediatrics", "Neonatology", "Child Psychiatry", "Pediatric Surgery", "Vaccinations"],
                "description": "Specialized care for children and adolescents with child-friendly environment",
                "distance": "3.8 miles",
                "email": "info@childrenshealth.org",
                "website": "www.childrenshealth.org",
                "beds": 180,
                "doctors": 65
            },
            {
                "id": "HOS_004",
                "name": "South City Clinic",
                "type": "clinic",
                "area": "south",
                "address": "321 Wellness St, South City",
                "phone": "(555) 456-7890",
                "emergency": false,
                "rating": 4.2,
                "specialties": ["General Medicine", "Dermatology", "Physiotherapy", "Dental Care", "Eye Care"],
                "description": "Outpatient clinic with specialist consultations and diagnostic services",
                "distance": "4.5 miles",
                "email": "appointments@southcityclinic.org",
                "website": "www.southcityclinic.org",
                "beds": 50,
                "doctors": 25
            },
            {
                "id": "HOS_005",
                "name": "Eastside Specialty Hospital",
                "type": "specialty",
                "area": "east",
                "address": "654 Care Ave, East City",
                "phone": "(555) 567-8901",
                "emergency": true,
                "rating": 4.6,
                "specialties": ["Cardiac Surgery", "Neurology", "Orthopedics", "Transplant", "Critical Care"],
                "description": "Advanced specialty care center with surgical facilities and ICU",
                "distance": "6.1 miles",
                "email": "contact@eastsidespecialty.org",
                "website": "www.eastsidespecialty.org",
                "beds": 280,
                "doctors": 85
            }
        ],
        "services": [
            {
                "id": "SRV_001",
                "name": "Emergency Services",
                "icon": "fas fa-ambulance",
                "description": "24/7 emergency care, trauma center, and ambulance services",
                "features": ["Trauma Care", "Critical Care", "Ambulance Service", "Emergency Surgery", "Stabilization"],
                "category": "emergency",
                "duration": "Immediate",
                "hospitals": ["HOS_001", "HOS_002", "HOS_003", "HOS_005"]
            },
            {
                "id": "SRV_002",
                "name": "Telemedicine",
                "icon": "fas fa-video",
                "description": "Virtual consultations with specialists from the comfort of your home",
                "features": ["Video Consultations", "E-Prescriptions", "Remote Monitoring", "Follow-ups", "Second Opinions"],
                "category": "consultation",
                "duration": "30-60 mins",
                "hospitals": ["HOS_001", "HOS_002", "HOS_003", "HOS_004"]
            },
            {
                "id": "SRV_003",
                "name": "Diagnostic Services",
                "icon": "fas fa-flask",
                "description": "Comprehensive lab tests, imaging, and health screenings",
                "features": ["Blood Tests", "X-ray & MRI", "Ultrasound", "Pathology", "Health Checkups"],
                "category": "diagnostics",
                "duration": "2-4 hours",
                "hospitals": ["HOS_001", "HOS_002", "HOS_004", "HOS_005"]
            },
            {
                "id": "SRV_004",
                "name": "Specialist Consultations",
                "icon": "fas fa-user-md",
                "description": "Expert consultations across all medical specialties",
                "features": ["Cardiology", "Neurology", "Orthopedics", "Dermatology", "Pediatrics", "Surgery"],
                "category": "consultation",
                "duration": "30-45 mins",
                "hospitals": ["HOS_001", "HOS_002", "HOS_003", "HOS_005"]
            },
            {
                "id": "SRV_005",
                "name": "Surgical Services",
                "icon": "fas fa-syringe",
                "description": "Advanced surgical procedures with modern technology",
                "features": ["Minimally Invasive", "Day Surgery", "Major Surgery", "Post-op Care", "Rehabilitation"],
                "category": "surgery",
                "duration": "Varies",
                "hospitals": ["HOS_001", "HOS_002", "HOS_005"]
            },
            {
                "id": "SRV_006",
                "name": "Maternity Care",
                "icon": "fas fa-baby",
                "description": "Complete care for expectant mothers and newborns",
                "features": ["Prenatal Care", "Delivery", "Postnatal Care", "Neonatal ICU", "Parenting Classes"],
                "category": "specialized",
                "duration": "9 months+",
                "hospitals": ["HOS_002", "HOS_003"]
            }
        ],
        "appointments": [],
        "healthCards": [],
        "lastAppointmentId": 0,
        "settings": {
            "autoSave": true,
            "notifications": true,
            "theme": "light",
            "emergencyContacts": ["911", "(555) 123-4567"]
        },
        "user": {
            "id": "USR_001",
            "name": "John Doe",
            "email": "john.doe@example.com",
            "phone": "+1 (555) 123-4567",
            "type": "patient",
            "address": "123 Main Street, City",
            "dateOfBirth": "1985-06-15",
            "bloodGroup": "O+",
            "emergencyContact": "+1 (555) 987-6543",
            "allergies": ["Penicillin", "Peanuts"]
        },
        "metadata": {
            "created": "2023-10-01",
            "lastUpdated": "",
            "version": "2.0",
            "totalAppointments": 0,
            "totalHealthCards": 0
        }
    }
    </script>

    <script>
        // ============================================
        // CITY MEDICAL CONNECT - COMPLETE APPLICATION
        // ============================================
        
        // Global application state
        const App = {
            data: null,
            currentTab: 'hospitals',
            toastQueue: [],
            isInitialized: false
        };
        
        // ============================================
        // INITIALIZATION
        // ============================================
        
        function initializeApp() {
            if (App.isInitialized) return;
            
            console.log('üöÄ Initializing City Medical Connect...');
            
            // Load data from HTML
            loadDataFromHTML();
            
            // Set up today's date for appointment form
            setMinDateForAppointment();
            
            // Render initial content
            renderAllSections();
            
            // Set up event listeners
            setupEventListeners();
            
            // Update storage status
            updateStorageStatus();
            
            // Update statistics
            updateStatistics();
            
            // Show welcome message
            setTimeout(() => {
                showToast('üè• Welcome to City Medical Connect!', 'info');
            }, 1000);
            
            App.isInitialized = true;
            console.log('‚úÖ Application initialized successfully');
        }
        
        // ============================================
        // DATA MANAGEMENT
        // ============================================
        
        function loadDataFromHTML() {
            try {
                const dataScript = document.getElementById('medical-data');
                if (dataScript) {
                    App.data = JSON.parse(dataScript.textContent);
                    
                    // Try to load saved data from localStorage as backup
                    const savedData = localStorage.getItem('cityMedicalDataBackup');
                    if (savedData) {
                        try {
                            const parsedSavedData = JSON.parse(savedData);
                            // Merge user data (appointments, health cards)
                            if (parsedSavedData.appointments) {
                                App.data.appointments = parsedSavedData.appointments;
                            }
                            if (parsedSavedData.healthCards) {
                                App.data.healthCards = parsedSavedData.healthCards;
                            }
                            if (parsedSavedData.lastAppointmentId) {
                                App.data.lastAppointmentId = parsedSavedData.lastAppointmentId;
                            }
                            console.log('üìÇ Loaded backup data from localStorage');
                        } catch (e) {
                            console.warn('Could not parse backup data from localStorage');
                        }
                    }
                    
                    // Update metadata
                    App.data.metadata.lastUpdated = new Date().toISOString();
                    App.data.metadata.totalAppointments = App.data.appointments.length;
                    App.data.metadata.totalHealthCards = App.data.healthCards.length;
                    
                    console.log(`üìä Data loaded: ${App.data.hospitals.length} hospitals, ${App.data.appointments.length} appointments`);
                    return true;
                } else {
                    throw new Error('No data found in HTML');
                }
            } catch (error) {
                console.error('‚ùå Error loading data:', error);
                // Create default data structure
                App.data = {
                    hospitals: [],
                    services: [],
                    appointments: [],
                    healthCards: [],
                    lastAppointmentId: 0,
                    settings: {},
                    user: {},
                    metadata: {}
                };
                showToast('‚ö†Ô∏è Could not load data. Using default configuration.', 'error');
                return false;
            }
        }
        
        function saveData() {
            try {
                // Update the script tag in HTML (in-memory)
                const dataScript = document.getElementById('medical-data');
                if (dataScript) {
                    // Update metadata before saving
                    App.data.metadata.lastUpdated = new Date().toISOString();
                    App.data.metadata.totalAppointments = App.data.appointments.length;
                    App.data.metadata.totalHealthCards = App.data.healthCards.length;
                    
                    dataScript.textContent = JSON.stringify(App.data, null, 2);
                }
                
                // Save to localStorage as backup
                const backupData = {
                    appointments: App.data.appointments,
                    healthCards: App.data.healthCards,
                    lastAppointmentId: App.data.lastAppointmentId,
                    user: App.data.user,
                    metadata: App.data.metadata
                };
                localStorage.setItem('cityMedicalDataBackup', JSON.stringify(backupData));
                
                updateStorageStatus();
                updateStatistics();
                console.log('üíæ Data saved successfully');
                return true;
            } catch (error) {
                console.error('Error saving data:', error);
                showToast('‚ö†Ô∏è Error saving data', 'error');
                return false;
            }
        }
        
        function backupData() {
            saveData();
            showToast('‚úÖ Data backed up successfully!', 'success');
        }
        
        // ============================================
        // RENDERING FUNCTIONS
        // ============================================
        
        function renderAllSections() {
            renderHospitals();
            renderServices();
            renderAppointments();
            renderHealthCards();
            populateHospitalSelect();
        }
        
        function renderHospitals() {
            const hospitalList = document.getElementById('hospital-list');
            if (!hospitalList) return;
            
            hospitalList.innerHTML = '';
            
            if (App.data.hospitals.length === 0) {
                hospitalList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-hospital"></i>
                        <h3>No Hospitals Found</h3>
                        <p>No hospital data available at the moment.</p>
                    </div>
                `;
                return;
            }
            
            App.data.hospitals.forEach(hospital => {
                const hospitalCard = document.createElement('div');
                hospitalCard.className = 'hospital-card';
                hospitalCard.innerHTML = `
                    <div class="hospital-header">
                        <div class="hospital-type">${hospital.type.toUpperCase()}</div>
                        <h3>${hospital.name}</h3>
                        <p>${hospital.description}</p>
                        <div class="hospital-rating">
                            <i class="fas fa-star"></i>
                            <span>${hospital.rating}/5</span>
                            <span>‚Ä¢ ${hospital.distance} away</span>
                            ${hospital.emergency ? '<span><i class="fas fa-ambulance"></i> 24/7 Emergency</span>' : ''}
                        </div>
                    </div>
                    <div class="hospital-body">
                        <div class="hospital-details">
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${hospital.address}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-phone"></i>
                                <span>${hospital.phone}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-compass"></i>
                                <span>${hospital.area} City</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-procedures"></i>
                                <span>${hospital.beds} Beds</span>
                            </div>
                        </div>
                        
                        <div class="specialties">
                            ${hospital.specialties.slice(0, 5).map(spec => 
                                `<span class="specialty-tag">${spec}</span>`
                            ).join('')}
                            ${hospital.specialties.length > 5 ? 
                                `<span class="specialty-tag">+${hospital.specialties.length - 5} more</span>` : 
                                ''
                            }
                        </div>
                        
                        <div class="hospital-actions">
                            <button class="btn btn-primary" onclick="bookAtHospital('${hospital.id}')">
                                <i class="fas fa-calendar-check"></i> Book Appointment
                            </button>
                            <button class="btn btn-secondary" onclick="viewHospitalDetails('${hospital.id}')">
                                <i class="fas fa-info-circle"></i> Details
                            </button>
                        </div>
                    </div>
                `;
                hospitalList.appendChild(hospitalCard);
            });
        }
        
        function renderServices() {
            const servicesList = document.getElementById('services-list');
            if (!servicesList) return;
            
            servicesList.innerHTML = '';
            
            App.data.services.forEach(service => {
                const serviceCard = document.createElement('div');
                serviceCard.className = 'service-card';
                serviceCard.innerHTML = `
                    <div class="service-icon">
                        <i class="${service.icon}"></i>
                    </div>
                    <h3>${service.name}</h3>
                    <p>${service.description}</p>
                    <ul class="service-features">
                        ${service.features.map(feature => 
                            `<li><i class="fas fa-check"></i> ${feature}</li>`
                        ).join('')}
                    </ul>
                    <button class="btn btn-secondary" onclick="findServiceProviders('${service.id}')" style="margin-top: 15px;">
                        <i class="fas fa-search"></i> Find Providers
                    </button>
                `;
                servicesList.appendChild(serviceCard);
            });
        }
        
        function renderAppointments() {
            const appointmentsTableBody = document.getElementById('appointments-table-body');
            const noAppointmentsElement = document.getElementById('no-appointments');
            
            if (!appointmentsTableBody) return;
            
            appointmentsTableBody.innerHTML = '';
            
            if (App.data.appointments.length === 0) {
                if (noAppointmentsElement) {
                    noAppointmentsElement.style.display = 'block';
                }
                return;
            }
            
            if (noAppointmentsElement) {
                noAppointmentsElement.style.display = 'none';
            }
            
            // Sort appointments by date (newest first)
            const sortedAppointments = [...App.data.appointments].sort((a, b) => 
                new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time)
            );
            
            sortedAppointments.forEach(appointment => {
                const hospital = App.data.hospitals.find(h => h.id === appointment.hospitalId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${hospital ? hospital.name : 'Unknown Hospital'}</td>
                    <td>${appointment.department}</td>
                    <td>${formatDate(appointment.date)} at ${appointment.time}</td>
                    <td>
                        <span class="status-badge status-${appointment.status}">
                            ${appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-secondary" onclick="cancelAppointment('${appointment.id}')" style="padding: 5px 10px; font-size: 0.9rem;">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button class="btn btn-primary" onclick="viewHealthCard('${appointment.id}')" style="padding: 5px 10px; font-size: 0.9rem; margin-left: 5px;">
                            <i class="fas fa-id-card"></i> View Card
                        </button>
                    </td>
                `;
                appointmentsTableBody.appendChild(row);
            });
        }
        
        function renderHealthCards() {
            const healthCardsList = document.getElementById('health-cards-list');
            const noCardsElement = document.getElementById('no-cards');
            const cardCountElement = document.getElementById('card-count');
            
            if (!healthCardsList) return;
            
            healthCardsList.innerHTML = '';
            
            if (App.data.healthCards.length === 0) {
                if (noCardsElement) {
                    noCardsElement.style.display = 'block';
                }
                if (cardCountElement) {
                    cardCountElement.textContent = '0 cards';
                }
                return;
            }
            
            if (noCardsElement) {
                noCardsElement.style.display = 'none';
            }
            
            if (cardCountElement) {
                cardCountElement.textContent = `${App.data.healthCards.length} card${App.data.healthCards.length !== 1 ? 's' : ''}`;
            }
            
            // Sort health cards by date (newest first)
            const sortedHealthCards = [...App.data.healthCards].sort((a, b) => 
                new Date(b.issuedDate) - new Date(a.issuedDate)
            );
            
            sortedHealthCards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'mini-health-card';
                cardElement.onclick = () => viewHealthCard(card.appointmentId);
                
                cardElement.innerHTML = `
                    <div class="mini-card-header">
                        <div>
                            <h4 style="margin: 0; font-size: 1.1rem;">${card.hospital}</h4>
                            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.8;">${card.department}</p>
                        </div>
                        <div class="mini-appointment-id">${card.appointmentId}</div>
                    </div>
                    <div class="mini-card-details">
                        <p><i class="fas fa-calendar-alt"></i> ${formatDate(card.date)} at ${card.time}</p>
                        <p><i class="fas fa-user"></i> ${card.patientName}</p>
                        <p>
                            <span class="status-badge status-${card.status}" style="font-size: 0.7rem; padding: 2px 8px;">
                                ${card.status.charAt(0).toUpperCase() + card.status.slice(1)}
                            </span>
                        </p>
                    </div>
                `;
                healthCardsList.appendChild(cardElement);
            });
        }
        
        function populateHospitalSelect() {
            const hospitalSelect = document.getElementById('hospital-select');
            if (!hospitalSelect) return;
            
            hospitalSelect.innerHTML = '<option value="">Choose a hospital...</option>';
            
            App.data.hospitals.forEach(hospital => {
                const option = document.createElement('option');
                option.value = hospital.id;
                option.textContent = `${hospital.name} (${hospital.area} - ${hospital.distance} away)`;
                hospitalSelect.appendChild(option);
            });
        }
        
        // ============================================
        // APPOINTMENT FUNCTIONS
        // ============================================
        
        function bookAppointment() {
            const hospitalId = document.getElementById('hospital-select').value;
            const department = document.getElementById('department-select').value;
            const date = document.getElementById('appointment-date').value;
            const timeSlot = document.getElementById('time-slot').value;
            const patientName = document.getElementById('patient-name').value;
            const contact = document.getElementById('patient-contact').value;
            const notes = document.getElementById('patient-notes').value;
            
            // Validation
            if (!hospitalId || !department || !date || !timeSlot || !patientName || !contact) {
                showToast('‚ö†Ô∏è Please fill all required fields', 'error');
                return;
            }
            
            const selectedHospital = App.data.hospitals.find(h => h.id === hospitalId);
            if (!selectedHospital) {
                showToast('‚ö†Ô∏è Selected hospital not found', 'error');
                return;
            }
            
            // Format time for display
            const timeMap = {
                '9-10': '9:00 AM',
                '10-11': '10:00 AM', 
                '11-12': '11:00 AM',
                '1-2': '1:00 PM',
                '2-3': '2:00 PM',
                '3-4': '3:00 PM',
                '4-5': '4:00 PM'
            };
            
            const displayTime = timeMap[timeSlot] || timeSlot;
            
            // Generate appointment ID
            App.data.lastAppointmentId++;
            const appointmentId = `APT_${Date.now().toString(36).toUpperCase()}`;
            const healthCardId = `CARD_${Date.now().toString(36).toUpperCase()}`;
            
            // Create appointment
            const newAppointment = {
                id: appointmentId,
                hospitalId: hospitalId,
                department: department,
                date: date,
                time: displayTime,
                status: 'confirmed',
                patientName: patientName,
                contact: contact,
                notes: notes || 'No additional notes',
                symptoms: notes || 'None reported',
                createdAt: new Date().toISOString(),
                appointmentNumber: `APPT-${App.data.lastAppointmentId.toString().padStart(6, '0')}`
            };
            
            // Create health card
            const newHealthCard = {
                id: healthCardId,
                appointmentId: appointmentId,
                hospital: selectedHospital.name,
                department: department,
                date: date,
                time: displayTime,
                patientName: patientName,
                status: 'confirmed',
                issuedDate: new Date().toISOString().split('T')[0],
                notes: notes || 'No additional notes',
                appointmentNumber: newAppointment.appointmentNumber
            };
            
            // Add to data
            App.data.appointments.unshift(newAppointment);
            App.data.healthCards.unshift(newHealthCard);
            
            // Save data
            saveData();
            
            // Update UI
            renderAppointments();
            renderHealthCards();
            
            // Show success message and health card
            showToast('‚úÖ Appointment booked successfully!', 'success');
            showHealthCardModal(newAppointment, newHealthCard);
            
            // Reset form
            document.getElementById('appointment-form').reset();
            document.getElementById('patient-name').value = 'John Doe';
            document.getElementById('patient-contact').value = '+1 (555) 123-4567';
        }
        
        function cancelAppointment(appointmentId) {
            if (!confirm('Are you sure you want to cancel this appointment?')) {
                return;
            }
            
            const appointmentIndex = App.data.appointments.findIndex(a => a.id === appointmentId);
            if (appointmentIndex === -1) {
                showToast('‚ö†Ô∏è Appointment not found', 'error');
                return;
            }
            
            const appointment = App.data.appointments[appointmentIndex];
            
            // Update appointment status
            appointment.status = 'cancelled';
            
            // Update corresponding health card
            const healthCardIndex = App.data.healthCards.findIndex(c => c.appointmentId === appointmentId);
            if (healthCardIndex !== -1) {
                App.data.healthCards[healthCardIndex].status = 'cancelled';
            }
            
            // Save data
            saveData();
            
            // Update UI
            renderAppointments();
            renderHealthCards();
            
            showToast('‚úÖ Appointment cancelled successfully', 'success');
        }
        
        function bookAtHospital(hospitalId) {
            switchTab('appointments');
            document.getElementById('hospital-select').value = hospitalId;
            document.getElementById('appointment-date').focus();
        }
        
        // ============================================
        // HEALTH CARD FUNCTIONS
        // ============================================
        
        function showHealthCardModal(appointment, healthCard = null) {
            if (!healthCard) {
                healthCard = App.data.healthCards.find(c => c.appointmentId === appointment.id);
            }
            
            if (!healthCard) return;
            
            const hospital = App.data.hospitals.find(h => h.id === appointment.hospitalId);
            
            // Update modal content
            document.getElementById('modal-appointment-id').textContent = healthCard.appointmentNumber;
            document.getElementById('modal-patient-name').textContent = appointment.patientName;
            document.getElementById('modal-hospital').textContent = hospital ? hospital.name : 'Unknown Hospital';
            document.getElementById('modal-department').textContent = appointment.department;
            document.getElementById('modal-datetime').textContent = `${formatDate(appointment.date)} at ${appointment.time}`;
            document.getElementById('modal-contact').textContent = appointment.contact;
            document.getElementById('modal-issued-date').textContent = formatDate(healthCard.issuedDate);
            document.getElementById('modal-notes').textContent = appointment.notes || 'No additional notes';
            
            // Update status
            const statusElement = document.getElementById('modal-status');
            statusElement.textContent = appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1);
            statusElement.className = `status-badge status-${appointment.status}`;
            
            // Show modal
            document.getElementById('health-card-modal').style.display = 'flex';
        }
        
        function viewHealthCard(appointmentId) {
            const appointment = App.data.appointments.find(a => a.id === appointmentId);
            if (appointment) {
                showHealthCardModal(appointment);
            }
        }
        
        function closeModal() {
            document.getElementById('health-card-modal').style.display = 'none';
        }
        
        function printHealthCard() {
            window.print();
        }
        
        function downloadHealthCard() {
            const appointmentId = document.getElementById('modal-appointment-id').textContent;
            showToast(`üìÑ Health card ${appointmentId} downloaded as PDF`, 'success');
        }
        
        function addToWallet() {
            const appointmentId = document.getElementById('modal-appointment-id').textContent;
            showToast(`‚úÖ Health card ${appointmentId} added to your wallet`, 'success');
            closeModal();
        }
        
        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        
        function switchTab(tabName) {
            // Update navigation
            document.querySelectorAll('.nav-tabs a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${tabName}`) {
                    link.classList.add('active');
                }
            });
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetSection = document.getElementById(`${tabName}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
                // Scroll to section
                setTimeout(() => {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
            
            App.currentTab = tabName;
        }
        
        function setMinDateForAppointment() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const dateInput = document.getElementById('appointment-date');
            if (dateInput) {
                dateInput.min = tomorrow.toISOString().split('T')[0];
                
                // Set default to tomorrow
                const defaultDate = new Date(tomorrow);
                defaultDate.setDate(defaultDate.getDate() + 7); // One week from tomorrow
                dateInput.value = defaultDate.toISOString().split('T')[0];
            }
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            if (isNaN(date)) return dateString;
            
            return date.toLocaleDateString('en-US', { 
                weekday: 'short',
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }
        
        function viewHospitalDetails(hospitalId) {
            const hospital = App.data.hospitals.find(h => h.id === hospitalId);
            if (!hospital) return;
            
            const details = `
üè• ${hospital.name}
üìç ${hospital.address}
üìû ${hospital.phone}
üìß ${hospital.email}
üåê ${hospital.website}

‚≠ê Rating: ${hospital.rating}/5
üöë Emergency: ${hospital.emergency ? '24/7 Available' : 'Not Available'}
üìç Area: ${hospital.area} City
üìè Distance: ${hospital.distance}
üõèÔ∏è Beds: ${hospital.beds}
üë®‚Äç‚öïÔ∏è Doctors: ${hospital.doctors}

ü©∫ Specialties:
${hospital.specialties.map(spec => `‚Ä¢ ${spec}`).join('\n')}

üìù ${hospital.description}
            `;
            
            alert(details);
        }
        
        function findServiceProviders(serviceId) {
            const service = App.data.services.find(s => s.id === serviceId);
            if (!service) return;
            
            const hospitals = App.data.hospitals.filter(h => 
                service.hospitals.includes(h.id)
            );
            
            if (hospitals.length === 0) {
                alert(`No hospitals found offering ${service.name}.`);
                return;
            }
            
            const hospitalList = hospitals.map(h => 
                `‚Ä¢ ${h.name} (${h.distance} away) - ${h.phone}`
            ).join('\n');
            
            alert(`üè• Hospitals offering ${service.name}:\n\n${hospitalList}\n\nClick "Book Appointment" to schedule.`);
        }
        
        function showUserProfile() {
            const user = App.data.user;
            const profile = `
üë§ Patient Profile
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Name: ${user.name}
Email: ${user.email}
Phone: ${user.phone}
Address: ${user.address}
Date of Birth: ${formatDate(user.dateOfBirth)}
Blood Group: ${user.bloodGroup}
Emergency Contact: ${user.emergencyContact}

‚ö†Ô∏è Allergies:
${user.allergies.map(allergy => `‚Ä¢ ${allergy}`).join('\n')}

üìä Statistics:
‚Ä¢ Appointments: ${App.data.appointments.length}
‚Ä¢ Health Cards: ${App.data.healthCards.length}
            `;
            
            alert(profile);
        }
        
        function scrollToTop(e) {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            switchTab('hospitals');
        }
        
        // ============================================
        // DATA MANAGEMENT FUNCTIONS
        // ============================================
        
        function exportHTMLWithData() {
            // Save current data
            saveData();
            
            // Get current HTML
            const htmlContent = document.documentElement.outerHTML;
            
            // Create download link
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `CityMedicalConnect_${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('üíæ HTML file with all data downloaded!', 'success');
        }
        
        function loadDataFromFile() {
            document.getElementById('dataFileInput').click();
        }
        
        document.getElementById('dataFileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const fileContent = e.target.result;
                    
                    // Try to extract data from HTML file
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(fileContent, 'text/html');
                    const dataScript = doc.getElementById('medical-data');
                    
                    if (dataScript) {
                        const importedData = JSON.parse(dataScript.textContent);
                        
                        // Import user data only (appointments, health cards)
                        if (importedData.appointments) {
                            App.data.appointments = importedData.appointments;
                        }
                        if (importedData.healthCards) {
                            App.data.healthCards = importedData.healthCards;
                        }
                        if (importedData.lastAppointmentId) {
                            App.data.lastAppointmentId = importedData.lastAppointmentId;
                        }
                        if (importedData.user) {
                            App.data.user = importedData.user;
                        }
                        
                        saveData();
                        renderAllSections();
                        showToast('‚úÖ Data imported successfully!', 'success');
                    } else {
                        // Try as JSON file
                        try {
                            const jsonData = JSON.parse(fileContent);
                            if (jsonData.appointments) {
                                App.data.appointments = jsonData.appointments;
                                App.data.healthCards = jsonData.healthCards || [];
                                App.data.lastAppointmentId = jsonData.lastAppointmentId || 0;
                                saveData();
                                renderAllSections();
                                showToast('‚úÖ Data imported from JSON file!', 'success');
                            }
                        } catch (jsonError) {
                            showToast('‚ùå Could not find valid data in the file', 'error');
                        }
                    }
                } catch (error) {
                    showToast(`‚ùå Error importing data: ${error.message}`, 'error');
                }
            };
            reader.readAsText(file);
        });
        
        function showDataInEditor() {
            saveData();
            
            const dataStr = JSON.stringify(App.data, null, 2);
            const newWindow = window.open();
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Medical Data Viewer</title>
                    <style>
                        body { font-family: monospace; padding: 20px; background: #f5f5f5; margin: 0; }
                        pre { background: white; padding: 20px; border-radius: 5px; border: 1px solid #ddd; overflow-x: auto; }
                        .actions { margin-bottom: 20px; display: flex; gap: 10px; }
                        button { padding: 10px 15px; background: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; }
                        button:hover { background: #004d99; }
                    </style>
                </head>
                <body>
                    <div class="actions">
                        <button onclick="window.print()">üñ®Ô∏è Print</button>
                        <button onclick="copyToClipboard()">üìã Copy</button>
                        <button onclick="window.close()">‚ùå Close</button>
                    </div>
                    <pre id="data">${dataStr}</pre>
                    <script>
                        function copyToClipboard() {
                            const text = document.getElementById('data').textContent;
                            navigator.clipboard.writeText(text).then(() => {
                                alert('‚úÖ Data copied to clipboard!');
                            });
                        }
                    <\/script>
                </body>
                </html>
            `);
        }
        
        function resetAllData() {
            if (!confirm('‚ö†Ô∏è WARNING: This will delete ALL your appointments and health cards. This action cannot be undone. Are you sure?')) {
                return;
            }
            
            // Reset to initial state
            loadDataFromHTML(); // This will reload from the embedded data
            
            // Clear appointments and health cards
            App.data.appointments = [];
            App.data.healthCards = [];
            App.data.lastAppointmentId = 0;
            
            // Save and re-render
            saveData();
            renderAllSections();
            
            showToast('üîÑ All data has been reset to initial state', 'success');
        }
        
        function updateStorageStatus() {
            const statusElement = document.getElementById('storage-info');
            if (statusElement) {
                const appointmentCount = App.data.appointments.length;
                const hospitalCount = App.data.hospitals.length;
                const lastUpdated = App.data.metadata.lastUpdated ? 
                    new Date(App.data.metadata.lastUpdated).toLocaleTimeString() : 'Never';
                statusElement.textContent = `${appointmentCount} appointments | ${hospitalCount} hospitals | Updated: ${lastUpdated}`;
            }
        }
        
        function updateStatistics() {
            // Update statistics display
            const statsElements = {
                'stats-hospitals': App.data.hospitals.length,
                'stats-appointments': App.data.appointments.length,
                'stats-services': App.data.services.length,
                'stats-healthcards': App.data.healthCards.length
            };
            
            Object.entries(statsElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            });
        }
        
        // ============================================
        // TOAST NOTIFICATIONS
        // ============================================
        
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(toast);
            
            // Remove after 5 seconds
            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 5000);
        }
        
        // ============================================
        // EVENT LISTENERS
        // ============================================
        
        function setupEventListeners() {
            // Navigation clicks
            document.querySelectorAll('.nav-tabs a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabName = this.getAttribute('href').substring(1);
                    switchTab(tabName);
                });
            });
            
            // Search functionality
            const searchButton = document.getElementById('search-button');
            const searchInput = document.getElementById('search-input');
            
            if (searchButton && searchInput) {
                searchButton.addEventListener('click', performSearch);
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') performSearch();
                });
            }
            
            // Filters
            const applyFiltersBtn = document.getElementById('apply-filters');
            const clearFiltersBtn = document.getElementById('clear-filters');
            
            if (applyFiltersBtn) {
                applyFiltersBtn.addEventListener('click', applyHospitalFilters);
            }
            
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', clearHospitalFilters);
            }
            
            // Appointment booking
            const bookAppointmentBtn = document.getElementById('book-appointment');
            if (bookAppointmentBtn) {
                bookAppointmentBtn.addEventListener('click', bookAppointment);
            }
            
            // Emergency appointment
            const emergencyAppointmentBtn = document.getElementById('emergency-appointment');
            if (emergencyAppointmentBtn) {
                emergencyAppointmentBtn.addEventListener('click', function() {
                    alert('üö® For immediate emergency assistance:\n\n1. Call 911\n2. Go to the nearest emergency room\n3. This platform can help schedule urgent care appointments during business hours');
                });
            }
            
            // Modal close
            const modal = document.getElementById('health-card-modal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModal();
                    }
                });
            }
            
            // Auto-save on form changes
            const appointmentForm = document.getElementById('appointment-form');
            if (appointmentForm && App.data.settings.autoSave) {
                appointmentForm.addEventListener('change', function() {
                    saveData();
                });
            }
            
            // Window beforeunload - remind to save
            window.addEventListener('beforeunload', function(e) {
                saveData();
            });
        }
        
        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const query = searchInput.value.trim().toLowerCase();
            
            if (!query) {
                renderHospitals();
                return;
            }
            
            // Search hospitals
            const results = App.data.hospitals.filter(hospital => 
                hospital.name.toLowerCase().includes(query) ||
                hospital.specialties.some(spec => spec.toLowerCase().includes(query)) ||
                hospital.area.toLowerCase().includes(query) ||
                hospital.description.toLowerCase().includes(query)
            );
            
            // Display results
            const hospitalList = document.getElementById('hospital-list');
            if (!hospitalList) return;
            
            hospitalList.innerHTML = '';
            
            if (results.length === 0) {
                hospitalList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-search"></i>
                        <h3>No Results Found</h3>
                        <p>No hospitals match your search for "${query}"</p>
                        <button class="btn btn-primary" onclick="clearSearch()" style="margin-top: 15px;">
                            <i class="fas fa-times"></i> Clear Search
                        </button>
                    </div>
                `;
                return;
            }
            
            // Render search results
            results.forEach(hospital => {
                const hospitalCard = document.createElement('div');
                hospitalCard.className = 'hospital-card';
                hospitalCard.innerHTML = `
                    <div class="hospital-header">
                        <div class="hospital-type">${hospital.type.toUpperCase()}</div>
                        <h3>${hospital.name}</h3>
                        <p>${hospital.description}</p>
                        <div class="hospital-rating">
                            <i class="fas fa-star"></i>
                            <span>${hospital.rating}/5</span>
                            <span>‚Ä¢ ${hospital.distance} away</span>
                            ${hospital.emergency ? '<span><i class="fas fa-ambulance"></i> 24/7 Emergency</span>' : ''}
                        </div>
                    </div>
                    <div class="hospital-body">
                        <div class="hospital-details">
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${hospital.address}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-phone"></i>
                                <span>${hospital.phone}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-compass"></i>
                                <span>${hospital.area} City</span>
                            </div>
                        </div>
                        
                        <div class="specialties">
                            ${hospital.specialties.slice(0, 3).map(spec => 
                                `<span class="specialty-tag">${spec}</span>`
                            ).join('')}
                        </div>
                        
                        <div class="hospital-actions">
                            <button class="btn btn-primary" onclick="bookAtHospital('${hospital.id}')">
                                <i class="fas fa-calendar-check"></i> Book Appointment
                            </button>
                        </div>
                    </div>
                `;
                hospitalList.appendChild(hospitalCard);
            });
            
            showToast(`üîç Found ${results.length} hospital${results.length !== 1 ? 's' : ''} matching "${query}"`, 'info');
        }
        
        function clearSearch() {
            document.getElementById('search-input').value = '';
            renderHospitals();
        }
        
        function applyHospitalFilters() {
            const typeFilter = document.getElementById('filter-type').value;
            const areaFilter = document.getElementById('filter-area').value;
            
            let filteredHospitals = App.data.hospitals;
            
            if (typeFilter) {
                filteredHospitals = filteredHospitals.filter(h => h.type === typeFilter);
            }
            
            if (areaFilter) {
                filteredHospitals = filteredHospitals.filter(h => h.area === areaFilter);
            }
            
            const hospitalList = document.getElementById('hospital-list');
            if (!hospitalList) return;
            
            hospitalList.innerHTML = '';
            
            if (filteredHospitals.length === 0) {
                hospitalList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-filter"></i>
                        <h3>No Hospitals Match Filters</h3>
                        <p>Try changing your filter criteria</p>
                    </div>
                `;
                return;
            }
            
            // Render filtered hospitals
            filteredHospitals.forEach(hospital => {
                const hospitalCard = document.createElement('div');
                hospitalCard.className = 'hospital-card';
                hospitalCard.innerHTML = `
                    <div class="hospital-header">
                        <div class="hospital-type">${hospital.type.toUpperCase()}</div>
                        <h3>${hospital.name}</h3>
                        <p>${hospital.description}</p>
                        <div class="hospital-rating">
                            <i class="fas fa-star"></i>
                            <span>${hospital.rating}/5</span>
                            <span>‚Ä¢ ${hospital.distance} away</span>
                        </div>
                    </div>
                    <div class="hospital-body">
                        <div class="hospital-details">
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${hospital.address}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-phone"></i>
                                <span>${hospital.phone}</span>
                            </div>
                        </div>
                        
                        <div class="specialties">
                            ${hospital.specialties.slice(0, 4).map(spec => 
                                `<span class="specialty-tag">${spec}</span>`
                            ).join('')}
                        </div>
                        
                        <div class="hospital-actions">
                            <button class="btn btn-primary" onclick="bookAtHospital('${hospital.id}')">
                                <i class="fas fa-calendar-check"></i> Book Appointment
                            </button>
                        </div>
                    </div>
                `;
                hospitalList.appendChild(hospitalCard);
            });
            
            showToast(`üîç Showing ${filteredHospitals.length} filtered hospital${filteredHospitals.length !== 1 ? 's' : ''}`, 'info');
        }
        
        function clearHospitalFilters() {
            document.getElementById('filter-type').value = '';
            document.getElementById('filter-area').value = '';
            renderHospitals();
            showToast('üóëÔ∏è Filters cleared', 'info');
        }
        
        // ============================================
        // INITIALIZE APPLICATION
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        
        // Expose functions to global scope for HTML onclick attributes
        window.switchTab = switchTab;
        window.bookAppointment = bookAppointment;
        window.bookAtHospital = bookAtHospital;
        window.viewHospitalDetails = viewHospitalDetails;
        window.findServiceProviders = findServiceProviders;
        window.viewHealthCard = viewHealthCard;
        window.cancelAppointment = cancelAppointment;
        window.closeModal = closeModal;
        window.printHealthCard = printHealthCard;
        window.downloadHealthCard = downloadHealthCard;
        window.addToWallet = addToWallet;
        window.showUserProfile = showUserProfile;
        window.scrollToTop = scrollToTop;
        window.exportHTMLWithData = exportHTMLWithData;
        window.loadDataFromFile = loadDataFromFile;
        window.showDataInEditor = showDataInEditor;
        window.resetAllData = resetAllData;
        window.backupData = backupData;
        
        console.log('üéØ City Medical Connect ready!');
    </script>
</body>
</html>
